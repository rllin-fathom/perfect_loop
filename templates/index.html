<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
  </head>
  <body>
    {% with messages = get_flashed_messages() %}
        {% if messages %}
            <ul class=flashes>
                {% for message in messages %}
                    <li>{{ message }}</li>
                {% endfor %}
            </ul>
        {% endif %}
    {% endwith %}

    <form method="POST" enctype="multipart/form-data" action="{{ url_for('index') }}">
        {{ form.csrf_token }}
        {{ form.upload }}
        <input id="start-bg-job" type="submit" value="Go">
    </form>
    <style>
        .progress {
              width: 100%;
              text-align: center;
        }
    </style>
    <script src="//cdnjs.cloudflare.com/ajax/libs/nanobar/0.2.1/nanobar.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
    <script type="text/javascript" src="//cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
    <script>
      $(document).ready(function() {
        namespace = '/test';
        var socket = io.connect(location.protocol + '//' + document.domain + ':' + location.port + namespace);
        socket.on('connect', function() {
            socket.emit('my_event', {data: 'I\'m connected!'});
        });
        socket.on('progress', function(msg) {
            console.log('Received: ' + msg.state);
            if (msg.state == 'SUCCESS') {
              console.log('Received: ' + msg.result);
            }
        });
      });
    </script>


  </body>
</html>
